# Express and HTML

In this lab, you're going to setup the Express web application framework and get started writing HTML web pages.

Express is a key part of the nodejs ecosystem. It's primary job is to route requests coming from user's browsers to JavaScript code.
Our first routings will simply send back static HTML pages, but more complex applications use this routing behavior to implement
client-server interactions and application logic.

## Express Setup

Change to your `CMS_450` directory and make a new directory called `Back_End`, which will hold all of the applications we'll develop
in this part of the class.

```
prompt$ cd ~/CMS_450
prompt$ mkdir Back_End
prompt$ cd Back_End
```

Make a directory named `hello_app` and `cd` into it:

```
prompt$ mkdir hello_app
prompt$ cd hello_app
```

Run `npm init` to create a basic node application. When the command executes it will prompt you to enter information about the app you're
creating. You can press `ENTER` to accept all the defaults **EXCEPT** the line that says

```
entry point (index.js)
```

Enter `app.js` for the entry point file, which will be the main Express application code.

When `init` finishes, install Express in your application with

```
prompt$ npm install express --save
```

## Hello, Express World

You are now ready to `touch app.js` and open it in the editor. Put the following code in and save the file:

```
const express = require('express')
const app = express()
const port = 80

app.get('/', (req, res) => res.send('Hello World!'))

app.listen(port, () => console.log(`Listening on port ${port}!`))
```

This is JavaScript code. 

- The first two lines import the `express` package and initialize it.

- The third line sets the port number for the application. The port is like a listening point managed by the OS. Every application that
maintains network access must have a unique port number that it listens on.  

  Many standard protocols have their own reserved port numbers. For example, HTTP servers traditionally listen on port 80 and
8080; SSH (secure shell for logging into a remote server) uses 22.

- The fourth line is the most important. It creates a route that maps a URL (`/`) to a function. The `/` path is the root document of
a site, the path that is generated when you access the base URL of a site.

  The function is an anonymous declaration using `=>` notation. The variable `req` is automatically generated by Express and can contain
information about the request. `res` is automatically generated by Express to handle the response. The function code (on the right
side of the arrow) sends back the text string `Hello, World!`.

- The final line actually creates the listening server on port 80.

To run the app, use

```
prompt$ node app.js
```

Open another terminal and type

```
prompt$ curl http://localhost:80
```

You should see `Hello, World!` print on the terminal. `curl` is a command for generating HTTP requests. The URL specifies the target of
the request is the local machine at port 80.

To view the app through your own web browser, use the "View" menu on Mimir and view port 80.

Return to the terminal and terminate the app by pressing `CTRL + c`. As a general rule, don't leave an app running if you aren't
actively testing it.

## A Certain HTML Index

Create an HTML file using `touch index.html`, then open it. Put the following code in:

```
<!DOCTYPE html>

<!-- This is an HTML comment. -->

<html>
    
    <!-- The head block is for page meta-information -->
    <head>
        <title>This appears as the browser tab title.</title>
    </head>
    
    <!-- The body is the page's content -->
    <body>
        
        <!-- <h1> is the top-level heading tag -->
        <h1>
            Hello, World!
        </h1>
        
        <!-- The <p> tag creates a paragraph of text -->
        
        <!-- The browser relies on tags to specify formatting. -->
        <!-- Most whitespace is ignored. -->
        <p>
            This is a web page that I wrote.
            
            It's all about peace and love and good happiness stuff.
        </p>
        
    </body>
    
</html>
```

Update your `app.js` to serve the new index page:

```
const express = require('express');
const app = express();
const port = 3000;
var path = require('path');

app.get('/', (req, res) => res.sendFile(path.join(__dirname, '/index.html')));

app.listen(port, () => console.log(`Example app listening on port ${port}!`));
```

The updated `app.get` line sends `index.html` in response to a request for the root of the site, `/`. `path.join` creates
an absolute path to `index.html`'s location. Express does not allow relative paths to files.

Re-run your app with `node app.js` and reload the web page. You should see the content of the HTML file.
